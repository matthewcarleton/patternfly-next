// Don't remove this magic comment. See gulpfile.js.
// @import "../../sass-utilities/all";

// Always keep list of spacers and breakpoints up-to-date
$pf-l-grid--breakpoint-map: build-breakpoint-map();

// URL.com/guidelines#layout
// Generate smart grid layout
// @parameter {Suffix} xs, sm, md, lg, xl, null
@mixin pf-smart-grid($suffix: null) {
  @for $col-num from 1 through 12 {
    &.pf-m-all-#{$col-num}-col#{$suffix} {
      > * {
        --pf-l-grid__item--GridColumnEnd: span #{$col-num};
      }
    }
  }
}

// Creates grid item
// @parameter {Suffix} xs, sm, md, lg, xl, null
@mixin pf-grid-item-modifier($suffix: null) {
  // generate column span modifier
  @for $col-num from 1 through 12 {
    > .pf-m-#{$col-num}-col#{$suffix} {
      --pf-l-grid__item--GridColumnEnd: span #{$col-num};
    }
  }

  // generate column offset modfiers
  @for $col-num from 1 through 12 {
    > .pf-m-offset-#{$col-num}-col#{$suffix} {
      --pf-l-grid__item--GridColumnStart: col-start calc(#{$col-num} + 1);
    }
  }

  // generate row span modfiers
  @for $row-num from 1 through 12 {
    > .pf-m-#{$row-num}-row#{$suffix} {
      grid-row: span #{$row-num};
    }
  }
}


// Grid base
.pf-l-grid {
  --pf-l-grid--m-gutter--GridGap: var(--pf-global--gutter);
  --pf-l-grid--m-gutter--md--GridGap: var(--pf-global--gutter--md);
  --pf-l-grid__item--GridColumnStart: auto;
  --pf-l-grid__item--GridColumnEnd: span 12;

  @media screen and (max-width: $pf-global--breakpoint--md) {
    --pf-l-grid--m-gutter--GridGap: var(--pf-l-grid--m-gutter--md--GridGap);
  }

  display: grid;
  grid-template-columns: repeat(12, [col-start] 1fr);

  &[class*="pf-m-justify-content"] {
    grid-template-columns: initial;
  }

  > *,
  .pf-l-grid__item {
    grid-column-start: var(--pf-l-grid__item--GridColumnStart);
    grid-column-end: var(--pf-l-grid__item--GridColumnEnd);
    min-width: 0;
    min-height: 0;
  }

  // Loop through $breakpoints map to generate responsive classes
  @each $breakpoint, $value in $pf-global--breakpoint-map {
    @include pf-media-query($breakpoint) {
      @include pf-smart-grid($value);
    }
  }

  // Loop through $breakpoints map to generate responsive classes
  @each $breakpoint, $value in $pf-global--breakpoint-map {
    @include pf-media-query($breakpoint) {
      @include pf-grid-item-modifier($value);
    }
  }

  &.pf-m-gutter {
    grid-gap: var(--pf-l-grid--m-gutter--GridGap);
  }

  &.pf-m-gutter-rows {
    grid-row-gap: var(--pf-l-grid--m-gutter--GridGap);
  }

  &.pf-m-gutter-columns {
    grid-column-gap: var(--pf-l-grid--m-gutter--GridGap);
  }

  @each $breakpoint, $breakpoint-value in $pf-l-grid--breakpoint-map {
    $breakpoint-name: if($breakpoint != "base", -on-#{$breakpoint}, "");

    @include pf-apply-breakpoint($breakpoint, $pf-l-grid--breakpoint-map) {
      // justify-items
      &.pf-m-justify-items-start#{$breakpoint-name} {
        justify-items: start;
      }

      &.pf-m-justify-items-center#{$breakpoint-name} {
        justify-items: center;
      }

      &.pf-m-justify-items-end#{$breakpoint-name} {
        justify-items: end;
      }

      &.pf-m-justify-items-stretch#{$breakpoint-name} {
        justify-items: stretch;
      }

      // align-items
      &.pf-m-align-items-start#{$breakpoint-name} {
        align-items: start;
      }

      &.pf-m-align-items-center#{$breakpoint-name} {
        align-items: center;
      }

      &.pf-m-align-items-end#{$breakpoint-name} {
        align-items: end;
      }

      &.pf-m-align-items-stretch#{$breakpoint-name} {
        align-items: stretch;
      }

      // justify-content
      &.pf-m-justify-content-start#{$breakpoint-name} {
        justify-content: start;
      }

      &.pf-m-justify-content-center#{$breakpoint-name} {
        justify-content: center;
      }

      &.pf-m-justify-content-end#{$breakpoint-name} {
        justify-content: end;
      }

      &.pf-m-justify-content-stretch#{$breakpoint-name} {
        justify-content: stretch;
      }

      &.pf-m-justify-content-space-around#{$breakpoint-name} {
        justify-content: space-around;
      }

      &.pf-m-justify-content-space-between#{$breakpoint-name} {
        justify-content: space-between;
      }

      &.pf-m-justify-content-space-evenly#{$breakpoint-name} {
        justify-content: space-evenly;
      }

      // align-content
      &.pf-m-align-content-start#{$breakpoint-name} {
        align-content: start;
      }

      &.pf-m-align-content-center#{$breakpoint-name} {
        align-content: center;
      }

      &.pf-m-align-content-end#{$breakpoint-name} {
        align-content: end;
      }

      &.pf-m-align-content-stretch#{$breakpoint-name} {
        align-content: stretch;
      }

      &.pf-m-align-content-space-around#{$breakpoint-name} {
        align-content: space-around;
      }

      &.pf-m-align-content-space-between#{$breakpoint-name} {
        align-content: space-between;
      }

      &.pf-m-align-content-space-evenly#{$breakpoint-name} {
        align-content: space-evenly;
      }

      &.pf-m-grid-auto-flow-column#{$breakpoint-name} {
        grid-auto-flow: column;
      }

      &.pf-m-grid-auto-flow-row#{$breakpoint-name} {
        grid-auto-flow: row;
      }

      &.pf-m-grid-auto-flow-dense#{$breakpoint-name} {
        grid-auto-flow: dense;
      }

      // justify-self
      .pf-m-justify-self-start#{$breakpoint-name} {
        justify-self: start;
      }

      .pf-m-justify-self-center#{$breakpoint-name} {
        justify-self: center;
      }

      .pf-m-justify-self-end#{$breakpoint-name} {
        justify-self: end;
      }

      .pf-m-justify-self-stretch#{$breakpoint-name} {
        justify-self: stretch;
      }

      // align-self
      .pf-m-align-self-start#{$breakpoint-name} {
        align-self: start;
      }

      .pf-m-align-self-end#{$breakpoint-name} {
        align-self: end;
      }

      .pf-m-align-self-center#{$breakpoint-name} {
        align-self: center;
      }

      .pf-m-align-self-stretch#{$breakpoint-name} {
        align-self: stretch;
      }
    }
  }
}
